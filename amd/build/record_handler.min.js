define(["jquery"],function(t){return{init:function(e,i,r,n,o){var s;function a(e,i){return t.ajax({type:"POST",url:`${o}/${e}`,dataType:"json",data:JSON.stringify(i),contentType:"application/json",cache:!1,processData:!1})}function c(){l(""),isRecording?function(){const t=a("stop-recording",{display_id:parseInt(currentDisplayId)});g("stopping"),t.done(function(t){isRecording=!isRecording,g("stopped"),currentDisplayId=null,window.localStorage.removeItem("mod_jitsi_record_display_id")}).fail(function(t){400===t.status&&l(d("recordNotActive")),500===t.status&&l(d("serverError")),g("started")})}():function(){const t=a("start-recording",{"jitsi-meet-url":`${n}/${e}`,instrutor:i});g("starting"),t.done(function(t){isRecording=!isRecording,g("started"),currentDisplayId=t.data.display_id}).fail(function(t){l(d("serverError")),g("stopped")})}()}function g(t){const e=document.querySelector("#mod_jitsi_record_button"),i=document.querySelector("#mod_jitsi_record_button img"),r=document.querySelector("#mod_jitsi_record_button #mod_jitsi_record_text");switch(t){case"started":i.setAttribute("src",imgSource.toStop),r.innerHTML=d("toStop"),e.removeAttribute("disabled");break;case"stopped":i.setAttribute("src",imgSource.toInit),r.innerHTML=d("toInit"),e.removeAttribute("disabled");break;case"starting":i.setAttribute("src",imgSource.starting),r.innerHTML=d("starting"),e.setAttribute("disabled","true");break;case"stopping":i.setAttribute("src",imgSource.stopping),r.innerHTML=d("stopping"),e.setAttribute("disabled","true");break;case"checking":i.setAttribute("src",imgSource.checking),r.innerHTML=d("checking"),e.setAttribute("disabled","true")}}function d(t){const e=Object.keys(strings).includes(r)?r:"en";return strings[e][t]?strings[e][t]:null}function l(t){document.querySelector("#mod_jitsi_record_button_error").innerHTML=t}isRecording=!1,imgSource={toInit:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24px' viewBox='0 0 24 24' width='24px' fill='%23000000'%3E%3Cpath d='M0 0h24v24H0V0z' fill='none'/%3E%3Cpath d='M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z'/%3E%3C/svg%3E",toStop:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24px' viewBox='0 0 24 24' width='24px' fill='%23ff0000'%3E%3Cpath d='M0 0h24v24H0V0z' fill='none'/%3E%3Cpath d='M16 8v8H8V8h8m2-2H6v12h12V6z'/%3E%3C/svg%3E",starting:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' enable-background='new 0 0 24 24' height='24px' viewBox='0 0 24 24' width='24px' fill='%23000000'%3E%3Cg%3E%3Crect fill='none' height='24' width='24'/%3E%3C/g%3E%3Cg%3E%3Cpath d='M18,22l-0.01-6L14,12l3.99-4.01L18,2H6v6l4,4l-4,3.99V22H18z M8,7.5V4h8v3.5l-4,4L8,7.5z'/%3E%3C/g%3E%3C/svg%3E",stopping:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' enable-background='new 0 0 24 24' height='24px' viewBox='0 0 24 24' width='24px' fill='%23000000'%3E%3Cg%3E%3Crect fill='none' height='24' width='24'/%3E%3C/g%3E%3Cg%3E%3Cpath d='M18,22l-0.01-6L14,12l3.99-4.01L18,2H6v6l4,4l-4,3.99V22H18z M8,7.5V4h8v3.5l-4,4L8,7.5z'/%3E%3C/g%3E%3C/svg%3E",checking:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' enable-background='new 0 0 24 24' height='24px' viewBox='0 0 24 24' width='24px' fill='%23000000'%3E%3Cg%3E%3Crect fill='none' height='24' width='24'/%3E%3C/g%3E%3Cg%3E%3Cpath d='M18,22l-0.01-6L14,12l3.99-4.01L18,2H6v6l4,4l-4,3.99V22H18z M8,7.5V4h8v3.5l-4,4L8,7.5z'/%3E%3C/g%3E%3C/svg%3E"},strings={pt_br:{toStop:"Parar gravação",toInit:"Iniciar gravação",starting:"Iniciando gravação",stopping:"Parando gravação",recordNotActive:"Gravação não foi iniciada",serverError:"Houve algum erro no servidor de gravação",checking:"Verificando gravação"},en:{toStop:"Stop recording",toInit:"Start recording",starting:"Starting recording",stopping:"Stopping recording",recordNotActive:"Recording is not active",serverError:"There was an error on the recording server",checking:"Checking recording"}},g("checking"),(s=`recording-status-by-url?meeting=${n}/${e}`,t.ajax({type:"GET",url:`${o}/${s}`,cache:!1,processData:!1})).done(function(t){isRecording=!0,currentDisplayId=t.data.display_id,g("started")}).fail(function(t){isRecording=!1,g("stopped"),window.localStorage.removeItem("mod_jitsi_record_display_id")}),t("#mod_jitsi_record_button").on("click",function(){c()})}}});